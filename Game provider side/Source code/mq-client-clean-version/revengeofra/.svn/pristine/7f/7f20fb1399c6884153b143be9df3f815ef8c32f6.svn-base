import SimpleController from '../../../../../common/PIXI/src/controller/base/SimpleController';
import GameOptimizationInfo from '../../model/custom/GameOptimizationInfo';
import { APP } from '../../../../../common/PIXI/src/globals';
import GameField from '../../main/GameField';
import GameScreen from '../../main/GameScreen';
import AwardingController from '../uis/awarding/AwardingController';
import FlameThrowersController from '../uis/weapons/flamethrower/FlameThrowersController';
import MoneyWheelController from './../uis/quests/wheel/MoneyWheelController';

class GameOptimizationController extends SimpleController {

	constructor()
	{
		super(new GameOptimizationInfo());
	}

	__init()
	{
		super.__init();

		this._gameScreen = APP.currentWindow;
		this._gameScreen.on(GameScreen.EVENT_ON_ROOM_PAUSED, this._onRoomPaused, this);
		this._gameScreen.once(GameScreen.EVENT_ON_READY, this._onGameScreenReady, this);	
		this._gameScreen.on(GameScreen.EVENT_ON_ROOM_FIELD_CLEARED, this._onRoomFieldCleared, this);
	}

	_onGameScreenReady()
	{
		this._gameScreen.gameField.on(GameField.EVENT_ON_BULLET_FLY_TIME, this._onBulletFlyTime, this);
		this._gameScreen.gameField.on(GameField.EVENT_ON_BULLET_TARGET_TIME, this._onBulletTargetTime, this);

		this._gameScreen.gameField.on(GameField.EVENT_ON_MINE_EXPLOSION_ANIMATION_STARTED, this._onMineExplosionAnimationStarted, this);
		this._gameScreen.gameField.on(GameField.EVENT_ON_MINE_EXPLOSION_ANIMATION_COMPLETED, this._onMineExplosionAnimationCompleted, this);

		this._gameScreen.gameField.on(GameField.EVENT_ON_CEILING_DUST_ANIMATION_STARTED, this._onCeilingDustAnimationStarted, this);
		this._gameScreen.gameField.on(GameField.EVENT_ON_CEILING_DUST_ANIMATION_COMPLETED, this._onCeilingDustAnimationCompleted, this);

		this._gameScreen.gameField.on('grenadeExplosionAnimationStarted', this._onGrenadeExplosionAnimationStarted, this);
		this._gameScreen.gameField.on(GameField.EVENT_ON_GRENADE_EXPLOSION_ANIMATION_COMPLETED, this._onGrenadeExplosionAnimationCompleted, this);

		let flameThrowersController = APP.currentWindow.flameThrowersController;
		flameThrowersController.on(FlameThrowersController.EVENT_ON_HIT_ANIMATION_STARTED, this._onFlameThrowerHitAnimationStarted, this);
		flameThrowersController.on(FlameThrowersController.EVENT_ON_HIT_ANIMATION_COMPLETED, this._onFlameThrowerHitAnimationCompleted, this);

		let awardingController = APP.currentWindow.awardingController;
		awardingController.on(AwardingController.EVENT_ON_AWARD_ANIMATION_STARTED, this._onAwardAnimationStarted, this);
		awardingController.on(AwardingController.EVENT_ON_AWARD_ANIMATION_INTERRUPTED, this._onAwardAnimationInterrupted, this);
		awardingController.on(AwardingController.EVENT_ON_AWARD_ANIMATION_COMPLETED, this._onAwardAnimationCompleted, this);
		awardingController.on(AwardingController.EVENT_ON_ALL_ANIMATIONS_COMPLETED, this._onAwardAllAnimationsCompleted, this);

		APP.currentWindow.gameField.once(GameField.EVENT_ON_GAME_FIELD_SCREEN_CREATED, this._onGameFieldScreenCreated, this);
	}

	_onGameFieldScreenCreated()
	{
		APP.currentWindow.gameField.moneyWheelController.on(MoneyWheelController.EVENT_ON_WIN_ANIMATION_STARTED, this._onMoneyWhellStarted, this);
		APP.currentWindow.gameField.moneyWheelController.on(MoneyWheelController.EVENT_ON_WIN_ANIMATION_COMPLETED, this._onMoneyWhellEnded, this);
	}

	_onRoomPaused(aEvent_obj)
	{
		this._clearAll();
	}

	_onRoomFieldCleared(aEvent_obj)
	{
		this._clearAll();
	}

	_onMineExplosionAnimationStarted()
	{
		this.info.i_increaseMineExplosionsNumber();
	}

	_onMineExplosionAnimationCompleted()
	{
		this.info.i_decreaseMineExplosionsNumber();
	}

	_onCeilingDustAnimationStarted()
	{
		this.info.i_increaseCeilingDustAnimationsNumber();
	}

	_onCeilingDustAnimationCompleted()
	{
		this.info.i_decreaseCeilingDustAnimationsNumber();
	}

	_onGrenadeExplosionAnimationStarted(event)
	{
		this.info.i_increaseGrenadeExplosionsNumber();
	}

	_onGrenadeExplosionAnimationCompleted(event)
	{
		this.info.i_decreaseGrenadeExplosionsNumber();
	}

	_onFlameThrowerHitAnimationStarted(event)
	{
		this.info.i_increaseFlameThrowerHitExplosionsNumber();
	}

	_onFlameThrowerHitAnimationCompleted(event)
	{
		this.info.i_decreaseFlameThrowerHitExplosionsNumber();
	}

	_clearAll()
	{
		this.info.i_clearAll();
	}

	//bullets...
	_onBulletFlyTime(event)
	{
		this.info.i_increaseCurrentShotsAmount();
	}

	_onBulletTargetTime(event)
	{
		this.info.i_decreaseCurrentShotsAmount();
	}
	//...bullets

	//awards...
	_onAwardAnimationStarted(event)
	{
		this.info.i_increaseCurrentAwardsAmount();
	}

	_onAwardAnimationInterrupted(event)
	{
		this.info.i_decreaseCurrentAwardsAmount();
	}

	_onAwardAnimationCompleted(event)
	{
		this.info.i_decreaseCurrentAwardsAmount();
	}

	_onAwardAllAnimationsCompleted(event)
	{
		this.info.i_resetCurrentAwardsAmount();
	}
	//...awards

	//money wheel...
	_onMoneyWhellStarted(event)
	{
		this.info.i_increaseCurrentMoneyWheelAmount();
	}

	_onMoneyWhellEnded(event)
	{
		this.info.i_decreaseCurrentMoneyWheelAmount();
	}
	//...money wheel

}

export default GameOptimizationController;