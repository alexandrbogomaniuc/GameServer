import Button from '../../../../../../../../../common/PIXI/src/display/ui/Button';
import Carousel from '../../player_collection/list/Carousel';
import { List } from '../../player_collection/list/List';
import { APP } from '../../../../../../../../../common/PIXI/src/globals';

class PromotionsScreenActivePromosCarousel extends Carousel
{
	constructor(activePromosList)
	{
		super(activePromosList);

		if (activePromosList)
		{
			activePromosList.on(List.EVENT_ON_ITEM_REMOVED, this._onItemRemoved, this);
		}
	}

	_addBase()
	{
	}

	get _contentContainerPosition()
	{
		return new PIXI.Point(0, 0);
	}

	get _visibleArea()
	{
		return new PIXI.Rectangle(0, 0, 360, 110);
	}

	_generatePrevButtonView()
	{
		let btn = new Button("promo/screen/btn_left", null, true);
		btn.position.set(this._visibleArea.width/2-50, this._visibleArea.height+35);
		btn.hitArea = new PIXI.Rectangle(-40, -22, 80, 44);

		return btn;
	}

	_generateNextButtonView()
	{
		let btn = new Button("promo/screen/btn_left", null, true);
		btn.position.set(this._visibleArea.width/2+50, this._visibleArea.height+35);
		btn.scale.x *= -1;
		btn.hitArea = new PIXI.Rectangle(-40, -22, 80, 44);

		return btn;
	}

	get _scrollStep()
	{
		return 360;
	}

	_onPrevBtnClicked(event)
	{
		if (APP.soundsController && APP.soundsController.play) // soundsController should be removed from here
		{
			APP.soundsController.play("mq_gui_button_accept");
		}

		super._onPrevBtnClicked(event);
	}

	_onNextBtnClicked(event)
	{
		if (APP.soundsController && APP.soundsController.play) // soundsController should be removed from here
		{
			APP.soundsController.play("mq_gui_button_accept");
		}
		
		super._onNextBtnClicked(event);
	}

	_enablePrevButton()
	{
		super._enablePrevButton();

		this._fPrevButton_btn.alpha = 1;
	}

	_disablePrevButton()
	{
		super._disablePrevButton();

		this._fPrevButton_btn.alpha = 0.4;
	}

	_enableNextButton()
	{
		super._enableNextButton();

		this._fNextButton_btn.alpha = 1;
	}

	_disableNextButton()
	{
		super._disableNextButton();

		this._fNextButton_btn.alpha = 0.4;
	}

	_onItemRemoved(event)
	{
		let list = event.target;
		let itemsAmount = list.data ? list.data.length : 0;
		let curCarouselStep = this._fCurrentStepIndex_int;

		this._moveToStep(curCarouselStep, true);
		if (curCarouselStep > 0 && curCarouselStep >= itemsAmount)
		{
			this._moveToStep(--curCarouselStep, true);
		}

		this._validateArrowButtons();
	}
}

export default PromotionsScreenActivePromosCarousel