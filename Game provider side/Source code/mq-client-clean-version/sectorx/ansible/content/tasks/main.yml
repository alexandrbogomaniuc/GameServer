---
  - name: Uploading lobby
    copy:
      src: "{{ build_root }}/sector-x-lobby.tar.gz"
      dest: "/home/users/{{ user }}/deploy/sector-x-lobby.tar.gz"

  - name: Uploading game
    copy:
      src: "{{ build_root }}/sector-x-game.tar.gz"
      dest: "/home/users/{{ user }}/deploy/sector-x-game.tar.gz"

  - name: Removing old backup
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/_backup"
      state: absent

  - name: Creating dir for backup
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/_backup"
      state: directory

  - name: Check lobby exists before backup
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/lobby/"
      state: directory

  - name: Creating lobby backup
    shell: "mv /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/lobby/ /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/_backup/lobby/"

  - name: Creating dir for lobby
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/lobby/"
      state: directory

  - name: Extracting lobby
    shell: "tar -xzf /home/users/{{ user }}/deploy/sector-x-lobby.tar.gz -C /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/lobby/"

  - name: Check game exists before backup
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/game/"
      state: directory

  - name: Creating game backup
    shell: "mv /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/game/ /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/_backup/game/"

  - name: Creating dir for game
    file:
      path: "/www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/game/"
      state: directory

  - name: Extracting game
    shell: "tar -xzf /home/users/{{ user }}/deploy/sector-x-game.tar.gz -C /www/html/{{ lobby_name }}/html5pc/actiongames/sectorx/game/"

