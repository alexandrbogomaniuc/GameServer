= MaxQuest
Betsoft Gaming
v4.1
:source-highlighter: coderay

== 1. Lobby Protocol
This document describes the communication protocol between client and the server in the “Max Quest” series of multiplayer games. +
Interaction is carried out via websockets in JSON format. +
The lobbyUrl and session id of the logged-in user are passed to the client through the http request parameters:
lobbyUrl (wss://host:port/websocket/mplobby), sessionId. +
Please note, that we recommend to use only secure websocket connections (wss://). +
Rooms can be created and deleted by the server as needed, depending on the current number of players. +
Type of all identifiers (id, rid, roomid, ..) is long.
As some features are game-specific, related fields in other games where not applicable should be ignored.

=== 1.1 Error handling
In response to any client request may come an error message like this:
[source,json]
{
  "code": 1,
  "msg": "Internal error",
  "date": 1496748898812,
  "class": "Error",
  "rid": 1
}

[source,json]
{
  "code": 2,
  "msg": "Server shutdown",
  "date": 1496748898812,
  "class": "Error",
  "rid": -1
}

[horizontal]
.Request parameters:
code:: error code
msg:: error description (may be localized)
date:: datetime in msec. from 01.01.1970 (standart unix timestamp)
class:: message class
rid:: request Id, type is int. Optional parameter, if not -1 this parameter contains id of original request.

[horizontal]
.Possible error ranges
1-999:: FATAL ERROR
1000-4999:: ERROR
5000-9999:: WARNING

Full list of error codes could be found in section 4

.Handling 'FATAL ERROR':
Display message to user and close lobby.

.Handling Lobby Websocket errors:
In case of websocket error, you must re-establishing websocket connection to lobbyUrl and send 'Enter Lobby' request.

=== 1.2 Enter Lobby
This request is a first request which should be send by the client after establishing websocket connection to lobby.
After that request, the client will be subscribed to receive asynchronous events: BalanceUpdated
[source,json]
{
  "sid": "4_eb0bf169cbb477b6f8430000015cbe83_fwRFDR4FWFZTV142PiQUCQ4H",
  "date": 1496750162302,
  "class": "EnterLobby",
  "rid": 1,
  "serverId": 1,
  "lang": "en",
  "mode": "real",
  "noFRB": false,
  "gameId": 779,
  "tournamentId": 123444,
  "bonusId": 56767,
  "battlegroundBuyIn": 100,
  "continueIncompleteRound": false
}

[horizontal]
.Request parameters:
sid:: session identifier (send as request parameter on start lobby client)
rid:: unique request id
serverId:: serverId for connect (send as request parameter on start lobby client)
mode:: money type: free, real, bonus
gameId:: game identifier (send as request parameter on start lobby client)
noFRB:: true if server should ignore active FRBs
tournamentId:: tournament identifier, optional. (send as request parameter on start lobby client for tournament play)
bonusId:: cash bonus identifier, optional, not null only for cash bonus mode (send as request parameter on start lobby client)
battlegroundBuyIn:: selected buyIn amount for battleground mode
continueIncompleteRound:: true when trying launch incomplete btg round

If session not found, invalid or expired server return
[source,json]
{
"code": 3,
"msg": "Invalid session",
"date": 1496750162288,
"class": "Error",
"rid": 1
}

If selected nickname contains an obscene word, server return:
[source,json]
{
  "code": 1000,
  "msg": "Illegal nickname",
  "date": 1496750162288,
  "class": "Error",
  "rid": 1
}

If session exist and enter to lobby is success, server return:
[source,json]
{
  "players": 600,
  "nickname": "Taras70",
  "nicknameEditable": true,
  "balance": 20000,
  "currency": { "code": "USD", "symbol": "$" },
  "rankPonts": 200,
  "roomId": 20,
  "level": 5,
  "avatar": {"borderStyle": 1, "hero": 1, "background": 2},
  "borders": [0, 1, 2, 3],
  "heroes": [0, 1, 2, 3],
  "backgrounds": [0, 1, 2, 3],
  "stakes": [2.0, 5.0, 10.0, 25.0, 50.0, 100.0],
  "paytable": {
    "enemyPayouts": [
      {
	    "idEnemy": 0,
        "nameEnemy": "Scarab black",
        "prize": { "minPayout": 10, "maxPayout": 20 }
      },
      {
        "idEnemy": 4,
        "nameEnemy": "Medium Mummy A",
        "prize": { "minPayout": 30, "maxPayout": 40 }
      }
    ],
    "energyBoss": 48,
    "lootboxPrizes": [
      {
        "number": 0,
        "prizes": [
          {
            "weaponId": 0,
            "min": 30,
            "max": 40
          },
          {
            "weaponId": 1,
            "min": 6,
            "max": 8
          }
        ]
      }
    ],
    "weaponPaidMultiplier": [
    ],
    "gemPayouts":{
      "0": [25, 30, 40],
	  "1": [20, 25, 30],
	  "2": [15, 18, 20],
	  "3": [10, 12, 15]
    },
    "healthByLevels":{
	  "0": [1200, 1350, 1500],
	  "1": [180, 200, 220],
	  "2": [450, 475, 500],
	  "3": [280, 300, 320],
	  "10": [400, 450, 500],
	  "11": [1000, 2500, 5000]
    },
    "enemyPayoutsByWeapon":{
      "0": {
        "0": {"minPayout": 30, "maxPayout": 150},
        "1": {"minPayout": 15, "maxPayout": 100}
      },
	  "1": {
        "0": {"minPayout": 20, "maxPayout": 170},
        "1": {"minPayout": 5, "maxPayout": 200}}
      }
    },
    "possibleBetLevels": [1, 2, 3, 5, 10],
    "moneyWheelPayouts": [25, 50, 100, 250, 500, 1000, 2000],
    "reels": {
      "1": [1, 4, 3, 5, 2, 4, 5],
      "2": [1, 5, 4, 2, 3, 4, 5],
      "3": [1, 4, 2, 5, 3, 4, 5]
    }
  },
  "frBonusInfo": {
    "id": 23142,
    "awardDate": 1533284885209,
    "expirationDate": 1533294885209,
    "totalShots": 500,
    "currentShots": 350,
    "winSum": 20000,
    "stake": 1
  },
  "cashBonusInfo": {
    "id": 23142,
    "awardDate": 1533284885209,
    "expirationDate": 1533294885209,
    "balance": 1000,
    "amount": 10000,
    "amountToRelease": 200,
    "status": "ACTIVE"
  },
  "tournamentInfo": {
    "id": 23142,
    "name": "New Year's tournament",
    "state": "ACTIVE",
    "startDate": 1533284885209,
    "endDate": 1533284885209,
    "balance": 10000,
    "buyInPrice": 1000,
    "buyInAmount": 10000,
    "reBuyAllowed": true,
    "reBuyPrice": 500,
    "reBuyAmount": 10000,
    "reBuyCount": 1,
    "reBuyLimit": -1,
    "resetBalanceAfterRebuy": false
  },
  "battlegroundInfo": {
     "buyIns": [100, 200, 500, 1000, 2000, 5000],
     "alreadySeatRoomId": 200133,
     "startGameUrl": "https://host/websocket/mpgame?SID=3453&serverId=1&lang=en&roomId=200133",
     "roomState": "WAIT",
     "buyInConfirmed": true
   }
  "showRefreshBalanceButton": true,
  "kills": 100,
  "treasures": 20,
  "rounds": 15,
  "xp": 123,
  "xpPrev": 100,
  "xpNext": 200,
  "place": 10,
  "disableTooltips": false,
  "needStartBonus": false,
  "nicknameGlyphs": "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",
  "stakesReserve": 300,
  "stakesLimit": 100,
  "alreadySitInStake": 2.0,
  "disableLeaderboard": false,
  "weaponMode": "LOOT_BOX",
  "date": 1496908464148,
  "date": 1587381071243,
  "rid": 1,
  "class": "EnterLobbyResponse"
}

[horizontal]
.Response parameters:
players:: total players logged in lobby
nickname:: player nickname, For new player nickname is null. See 'CheckNicknameAvailability' and 'ChangeNickName' requests.
nicknameEditable:: true if nickName may be changed, see ChangeNickname request
balance:: current player balance in cents (this is casino side balance, ALL available money). For tournament/cashbonus modes equals to tournament.balance and cashbonus.balance
currency:: player currency. Further in this document, all money in player currency
rankPoints:: total number of points received by the player, see 4.3 section is spec.
avatar:borderStyle:: current avatar borderStyle identifier.
avatar:hero:: current  avatar hero identifier.
avatar:background:: current avatar background identifier.
stakes:: list stakes (cost per shot) available to player
borders, heroes, backgrounds:: - list available avatar parts, see 'ChangeAvatar' request for customize avatar properties.
paytable:: paytable for enemies.
bossExtraPayoutsSpecial:: Prizes for special weapons at boss.
level:: Current player's level
rid:: unique request id
roomId:: roomId if player already seat in room; -1 if not. If a player occupies a place in a room, the lobby client must prompt the player to continue the game. If the player agrees, the game is started for the given room (send request “GetStartGameUrl” and open game client window)
frBonusInfo:: FRB only parameter, always null for real/free/cashbonus/tournament.
cashBonusInfo:: CashBonus only parameter, always null for real/free/frbonus/tournament.
cashBonusInfo:balance:: current balance. Shots reduce balance, wins increase
cashBonusInfo:amount:: initial bonus balance
cashBonusInfo:amountToRelease:: amount of bets required to release the bonus
cashBonusInfo:status:: current bonus status (ACTIVE, RELEASED, LOST, CANCELLED, EXPIRED, CLOSED)
tournamentInfo:: tournament only parameter, always null for real/free/frbonus/cashbonus
tournamentInfo:id:: unique tournament identifier
tournamentInfo:name:: tournament name (may be localized)
tournamentInfo:state:: current tournament status (READY, ACTIVE, FINISHED, CANCELED)
tournamentInfo:balance:: current player balance in tournament
tournamentInfo:buyInPrice:: price of participation in tournament
tournamentInfo:buyInAmount:: amount of tournament money which player receives at start of tournament
tournamentInfo:reBuyAllowed:: flag indicating that re-buys allowed
tournamentInfo:reBuyPrice:: price of purchase of additional tournament money
tournamentInfo:reBuyAmount:: amount of tournament money which player receives after re-buy
tournamentInfo:reBuyCount:: current re-buys count
tournamentInfo:reBuyLimit:: re-buys limit, (-1 for unlimited)
tournamentInfo:resetBalanceAfterRebuy:: after re-buy all balance reset to re-buy amount
disableTooltips:: enabled/disabled tooltips for player. (see 'ChangeToolTips' request)
stakesReserve:: number of stakes to be transferred from balance
stakesLimit:: limit of stakes after which you need to make additional buyIn
alreadySitInStake:: stake if player seat in room (see roomId), 0 if not.
disableLeaderboard:: booleader flag, if true - leaderboard functionality in client should be disabled
needStartBonus:: true/false, this is welcome bonus for first start game.
Player receives a special weapon as a gift
nicknameGlyphs:: symbols which could be used for nicknames
weaponMode:: LOOT_BOX or PAID_SHOTS
enemyPayoutsByWeapon:: map of min/max payouts by weapons for all enemies. keys are enemyTypeId(first), weaponId(second).
reels:: in DragonStone order of symbols on reels
battlegroundInfo:: info about available battlegrounds
battlegroundInfo:buyIns:: buyIns available
battlegroundInfo:alreadySeatRoomId:: roomId if the player already has incomplete (paid) battleground round
battlegroundInfo:startGameUrl:: url must be used for start game client.
If this parameter specified, need immediate open client (see specification about explanatory message before open).
battlegroundInfo:roomState:: room state if player open room, possible values: WAIT, PLAY, QUALIFY, CLOSED
battlegroundInfo:buyInConfirmed:: buyIn confirmed and room open

=== 1.3 CheckNicknameAvailability

After entering the lobby, the player must choose a nickname that will be visible to all other players.
To check whether the selected nickname is available, this request is available.

[source,json]
{
  "nickname": "Taras",
  "date": 1531731629785,
  "rid": 234,
  "class": "CheckNicknameAvailability"
}

[source,json]
.Success response:
{
  "date": 1531731629785,
  "rid": 1,
  "class": "Ok"
}

[source,json]
.Error responses:
{
  "code": 1015,
  "msg": "Nickname not available",
  "date": 1531731629785,
  "rid":1,
  "class": "Error"
}
{
  "code": 1000,
  "msg": "Illegal nickname",
  "date": 1531731629785,
  "rid": 1,
  "class": "Error"
}

=== 1.4 ChangeNickname
[source,json]
{
  "nickname": "Taras",
  "date": 1531731629785,
  "rid": 234,
  "class": "ChangeNickname"
}

[source,json]
.Success response:
{
  "date": 1531731629785,
  "rid": 1,
  "class": "Ok"
}

[source,json]
.Error responses:
{
  "code": 1016,
  "msg": "Nickname not available",
  "date": 1531731629785,
  "rid": 1,
  "class": "Error"
}
{
  "code": 1000,
  "msg": "Illegal nickname",
  "date": 1531731629785,
  "rid": 1,
  "class": "Error"
}
{
  "code": 1028,
  "msg": "Not allowed change nickname",
  "date": 1531731629785,
  "rid": 1,
  "class": "Error"
}

=== 1.5 ChangeAvatar
[source,json]
{
  "borderStyle": 1,
  "hero": 2,
  "background": 3,
  "date": 1531731629785,
  "rid": 234,
  "class": "ChangeAvatar"
}

[source,json]
.Success response:
{
  "date": 1531731629785,
  "rid": 1,
  "class":
  "Ok"
}
[source,json]
.Error responses:
{
  "code": 1017,
  "msg": "Avatar part not available",
  "date": 1531731629785,
  "rid": 1,
  "class": "Error"
}

=== 1.6 GetRoomInfo
When the user selects a particular game room, the client requests the server for detailed information about the selected room by a request like:
[source,json]
{
  "roomId": 1,
  "rid": 5,
  "date": 1496921495447,
  "class": "GetRoomInfo"
}

[horizontal]
.Request parameters:
roomId:: unique room id
rid:: unique request id

[source,json]
.Response:
{
  "roomId": 1,
  "name": "VIP#1",
  "maxSeats": 8,
  "minBuyIn": 10000,
  "stake": 0.1,
  "playerStake": 0.05,
  "state": "WAIT",
  "seats": [
    {
	  "id": 1,
	  "nickname": "Taras",
      "enterDate": 1497004331679,
      "totalScore": 700,
	  "currentScore": 10,
	  "avatar": {
		"borderStyle": 1,
		"hero": 1,
		"background": 10
	  },
	  "specialWeaponId": 1,
	  "level": 2,
	  "unplayedFreeShots": 0,
      "totalDamage": 100,
      "betLevel": 1
	},
	{
      "id": 2,
	  "nickname": "Bulba",
      "enterDate": 1497004331679,
	  "totalScore": 230,
	  "currentScore": 15,
	  "avatar": {
	    "borderStyle": 1,
	    "hero": 1,
	    "background": 10
	  },
	  "specialWeaponId": 2,
	  "level": 3,
	  "unplayedFreeShots": 0,
      "totalDamage": 0,
      "betLevel": 10
	},
	{
	  "id": 3,
	  "nickname": "Mikola",
      "enterDate": 1497004331679,
	  "totalScore": 10,
	  "currentScore": 5,
	  "avatar": {
		"borderStyle": 1,
		"hero": 1,
		"background": 10
	  },
	  "specialWeaponId": 3,
	  "level": 4,
	  "unplayedFreeShots": 10,
      "totalDamage": 245,
      "betLevel": 5
	}
  ],
  "ttnx": 7,
  "width": 800,
  "height": 600,
  "enemies": [
	{
	  "id": 1,
	  "width": 10,
	  "height": 30,
	  "speed": 10,
	  "prizes": 3,
	  "sumAward": 6,
	  "skins": 1,
	  "boss": false
	},
	{
	  "id": 2,
	  "width": 15,
	  "height": 40,
	  "speed": 70,
	  "prizes": 4,
	  "sumAward": 0,
	  "skins": 2,
	  "boss": true
	}
  ],
  "roomEnemies": [
    {
      "id": 18684,
	  "typeId": 1,
	  "speed": 10.0,
	  "awardedPrizes": "",
	  "awardedSum": 0.0,
	  "energy": 0,
      "fullEnergy": 100.0,
	  "skin": 1,
	  "trajectory": [
	    { "x": 10, "y": 50, "time": 120 },
		{ "x": 20, "y": 30, "time": 150 }
      ],
      "parentEnemyId": -1,
      "members": [],
      "swarmId": 0,
      "swarmType": 0
    },
	{
	  "id": 18693,
	  "typeId": 8,
	  "speed": 10.0,
	  "awardedPrizes": "",
	  "awardedSum": 0.0,
	  "energy": 0,
      "fullEnergy": 100.0,
	  "skin": 1,
	  "trajectory": [
	    { "x": 15, "y": 40, "time": 120 },
	    { "x": 25, "y": 70, "time": 190 }
	  ],
      "parentEnemyId": -1,
      "members": [],
      "swarmId": 1,
      "swarmType": 3
	}
  ],
  "alreadySitInNumber": -1,
  "alreadySitInAmmoCount": 0,
  "alreadySitInBalance": 0,
  "alreadySitInWin": 0.25,
  "mapId": 1,
  "subround": "BASE",
  "ammoValues": [100, 200, 500, 1000, 2000, 5000, 10000, 20000, 50000, 1000000],
  "mines": [],
  "freezeTime": {},
  "immortalBoss": false,
  "roundId": 450122,
  "seatGems": {},
  "cashBonusInfo": {
    "id": 23142,
    "awardDate": 1533284885209,
    "expirationDate": 1533294885209,
    "balance": 1000,
    "amount": 10000,
    "amountToRelease": 200,
    "status": "ACTIVE"
  },
  "tournamentInfo": {
    "id": 23142,
    "name": "New Year's tournament",
    "state": "ACTIVE",
    "startDate": 1533284885209,
    "endDate": 1533284885209,
    "balance": 10000,
    "buyInPrice": 500,
    "buyInAmount": 10000,
    "reBuyAllowed": true,
    "reBuyPrice": 500,
    "reBuyAmount": 100000,
    "reBuyCount": 1,
    "reBuyLimit": -1,
    "resetBalanceAfterRebuy": false
  },
  "battlegroundInfo" {
    "buyIn" : 1000,
    "buyInConfirmed": true,
    "timeToStart" : 30,
    "kingsOfHill": [1,2,3],
    "score": 4620,
    "rank" : 3,
    "pot": 3960,
    "potTaxPercent": 5
  },
  "betLevel": 1,
  "date": 1497004331658,
  "rid": 5,
  "class": "GetRoomInfoResponse"
}

.Where:
[horizontal]
rid:: request id from “GetRoomInfo”
roomId:: unique room id
name:: room name
maxSeats:: max seats in room
minBuyIn:: minimal buyIn in cents for occupy seat (type – float)
stake:: room stake (shot cost) in cents (type – float). This just stake limit.
playerStake:: player stake (shot cost) in cents (type – float). Always in player currency. If player not seater, playerStake=-1
state:: current room state. Possible values: WAIT, PLAY, QUALIFY, CLOSED
ttnx:: rough time to next state in seconds, -1 for unknown (ttnx -Time To NeXt).
mapId:: current map identifier
width:: virtual width of the playing area
height:: virtual height of the playing area
alreadySitInNumber:: seat number; -1 if player not seat in room;
alreadySitInAmmoAmount:: current ammo amount if player seat in room; 0 if player not seat
alreadySitInBalance:: current player balance if player seat in room; 0 if player not seat
alreadySitInWin:: player's win in current round
seats:: list of players who have taken their seat and ready to play (or already playing)
enemies:: list of enemy types that can appear in this room.
roomEnemies:: list of alive enemies in this room. Please do not jumble it, “roomEnenemies” are specific instances, but “enemies” are the types of the enemies.
weapons:: list of weapons available in the room
seat:id:: seat number, may be 0...(maxSeats-1)
seat:nickname:: seat nickname
seat:avatar:: seat avatar
seat:enterDate:: date when the player started the game
seat:totalScore:: total number of points awarded player in this room (total win = totalScore*stake), type=integer
seat:currentScore:: number of points awarded player for current round (currentWin = currentScore*stake), type=integer
seat:rankPoints:: total number of points received by the player, see 4.3 section is spec.
enemy:id:: unique enemy type identifier
enemy:name:: enemy name
enemy:width,height:: rectangle in which should be placed enemy
enemy:speed:: max speed in points/sec.
enemy:prizes:: number of prizes available for this type of enemy
enemy:sumAward:: total awarded ponts available for this type of enemy (real win = sumAward*stake)
enemy:energy:: Boss only property (can be used to identify the boss). Total points available for this boss. Each energy point represents 1 credit.
enemy:skins:: skins count available for this enemy.
enemy:boss:: flag indicating that this enemy is the boss; when this enemy type appears, you need remove the special weapon and use regular weapon.
roomEnemy:id:: unique enemy identifier
roomEnemy:typeid:: enemy type identifier (reference to enemy.id)
roomEnemy:awardedPrizes:: prizes (list!) received from hitting the enemy. May be empty if no hits.
roomEnemy:awardedSum:: amount of points received from hits to the enemy
roomEnemy:energy:: remaining energy, if energy<0 enemy is dead, remember that energy=0 used for identify regular enemies
roomEnemy:skin:: skin number (randomly generated, from 1 to enemy.skins)
roomEnemy:trajectory:: Trajectory (set of points) along which enemies move
roomEnemy:trajectory:x, y:: current x/y coordinate (x=0, y=0 for bottom left corner)
roomEnemy:trajectory:time:: at this time the enemy must be at a given point
ammoValues:: possible ammo values for buyIn
cashBonusInfo:: same as EnterLobbyResponse.cashBonusInfo
tournamentInfo:: same as EnterLobbyResponse.tournamentInfo
betLevel:: current player's bet level
battlegroundInfo:: battleground info, always null for other modes
battlegroundInfo:buyIn:: buyIn amount for join
battlegroundInfo:buyInConfirmed:: true if buyIn confirmed by player
battlegroundInfo:timeToStart:: time to start next battleground round in seconds
battlegroundInfo:kingsOfHill:: Kings of the Hill seat number ids
battlegroundInfo:score:: current player score (ath this moment always total win amount)
battlegroundInfo:rank:: current player rank
battlegroundInfo:pot:: pot amount
battlegroundInfo:potTaxPercent:: casino tax percentage of pot amount


=== 1.7 SubscribeRoomInfo
Request removed

=== 1.8 UnsubscribeRoomInfo

Request removed

=== 1.9 GetStartGameUrl
After player double click on any room, lobby client send request to server for obtain url for start game.
[source,json]
{
  "roomId": 1,
  "stake": 5,
  "date": 1497154790288,
  "rid": 5,
  "class": "GetStartGameUrl"
}

[horizontal]
.Request parameters:
roomId:: unique room id (may be not specified, in this case the room will be selected by the server based on stake param)
stake:: selected stake
rid:: unique request id
Response:
[source,json]
{
  "roomId": 5,
  "startGameUrl": "https://host/mpgameloader.jsp?sid=deb0bf169cbb477b6f8430000015cbe83&serverId=1&roomId=5&stake=5",
  "date": 1497155412200,
  "rid": 1,
  "class": "GetStartGameUrlResponse"
}

[horizontal]
.Where:
rid:: request id from “GetRoomInfo”
roomId:: unique room id
startGameUrl:: url for start game.

After receiving this response, the client should connect to game room using params from startGameUrl

=== 1.10 CreateRoom
This message is sent by the server after creating a new room
[source,json]
{
  "id": 10,
  "date": 1497154444100,
  "rid": -1,
  "name": "VIP#10",
  "seats": 0,
  "maxSeats": 6,
  "minBuyIn": 10000,
  "stake": 0.1,
  "state": "WAIT",
  "ttnx": -1,
  "width": 800,
  "height": 600,
  "mapId": 1,
  "class": "CreateRoom"
}

[horizontal]
.Where:
id:: unique room id (type is long)
date:: datetime in msec. from 01.01.1970 (standart unix timestamp)
rid:: request id, always -1
name:: room name
seats:: current seats count
maxSeats:: max seats in room
minBuyIn:: minimal buyIn in cents for occupy seat
stake:: cost per shot in cents (type – float)
state:: current room state. Possible values: WAIT, PLAY, QUALIFY, CLOSED
ttnx:: rough time to next state in seconds, -1 for unknown (ttnx -Time To NeXt).
width:: virtual width of the playing area
height::  virtual height of the playing area
mapId:: current map identifier
class:: message class

=== 1.11 RemoveRoom
This message is sent by the server after deleting the room.
[source,json]
{
  "id": 10,
  "date": 1497154444100,
  "rid": -1,
  "class": "RemoveRoom"
}

[horizontal]
.Where:
id:: unique room id (type is long)
date:: datetime in msec. from 01.01.1970 (standart unix timestamp)
rid:: request id, always -1
class:: message class

=== 1.12 Leaderboards
At any time client can request list of Leaderboards
[source,json]
.Request
{
  "class": "GetLeaderboards",
  "date": 1496748898812,
  "rid": 1
}

[source,json]
.Response
{
  "class": "Leaderboards",
  "date": 1496748898812,
  "rid": 1,
  "leaderboards": [
    { "id": 1, "start": 140000000000, "end": 141000000000, "awards": 1000 },
    { "id": 2, "start": 141000000000, "end": 142000000000, "awards": 100 }
  ],
  "currentId": 2,
  "previousId": 1
}

=== 1.13 Leaderboard Scores
At any time client can request current Leaderboard state
[source,json]
.Request
{
  "class": "GetLeaderboardScores",
  "date": 1496748898812,
  "rid": 2,
  "leaderboardId": 1,
  "from": 1,
  "to": 6
}

[source,json]
.Response
{
  "class": "LeaderboardScores",
  "date": 1496748898812,
  "rid": 2,
  "leaderboardId": 1,
  "prizePlaces": 5,
  "currency": { "code": "EUR", "symbol": "€" },
  "awards": [
    { "place": 1, "type": "special", "value": "Porsche 911", "name": "Kenny", "score": 1000 },
    { "place": 2, "type": "money", "value": 1000, "name": "Cartman", "score": 800 },
    { "place": 3, "type": "money", "value": 500, "name": "Sten", "score": 700 },
    { "place": 4, "type": "money", "value": 500, "name": "Wendy", "score": 650 },
    { "place": 5, "type": "money", "value": 500, "name": "Kyle", "score": 500 }
    { "place": 6, "name": "Butters", "score": 499 }
  ],
  "totalPlayers": 10000,
  "position": 3
}

Note: Leaderboard prize functionality was removed from the game

=== 1.14 LeaderboardPosition
To find position of current player in a leaderboard, client can send following message
[source,json]
.Request
{
  "class": "GetLeaderboardPosition",
  "date": 1496748898812,
  "rid": 1,
  "leaderboardId": 1
}

[source,json]
.Response
{
  "class": "LeaderboardPosition",
  "date": 1496748898812,
  "rid": 1,
  "leaderboardId": 1,
  "score": {
    "type": "SPECIAL",
    "value": "Porsche 911",
    "place": 1,
    "score": 1000,
    "nickname": "Kenny"
  }
}

=== 1.15 BalanceUpdated
This message sent by server side after changing player balance.
Balance is checked every 15 seconds on server side.

[source,json]
.Response
{
  "class": "BalanceUpdated",
  "date": 1496748898812,
  "rid": -1,
  "balance": 1236600,
  "serverAmmo": 293
}

=== 1.16 GetLobbyTime
Sended from client each N seconds.  N(MQ_TIMER_FREQ) in getParams() in template.jsp.
[source,json]
.Request
{
  "class": "GetLobbyTime",
  "date": 1496748898812,
  "rid": 10
}
.Response
{
  "class": "LobbyTimeUpdated",
  "date": 1496748898813,
  "rid": 10
}

=== 1.18 ChangeToolTips
This message should be send to update Tooltips visibility in player settings
[source,json]
.Request
{
  "disableTooltips": true,
  "date": 1531731629785,
  "rid": 234,
  "class": "ChangeToolTips"
}

This message will be processed without any response

=== 1.19 Active Quests
At any time client can request list of active quests of player
[source,json]
.Request
{
  "class": "GetQuests",
  "date": 1496748898812,
  "rid": 1
}
[source,json]
.Response
{
  "class": "Quests",
  "date": 1496748898812,
  "rid": 1,
  "quests": [
    {
      "id": 1,
      "type": 1,
      "roomCoin": 5
      "needReset": true,
      "collectAmount": 1,
      "name": "Quest1",
      "progress": {
        "treasures": [
          {"treasureId": 2, "collect": 2, "goal": 3},
          {"treasureId": 1, "collect": 1, "goal": 3},
        ]
      },
      "questPrize": {
        "amount": {
          "from": 50,
          "to": 100
        },
        "specialWeaponId": 4
      }
    },
    {
      "id": 2,
      "type": 0,
      "roomCoin": 2
      "needReset": false,
      "collectAmount": 2,
      "name": "Quest2",
      "progress": {
        "treasures": [
          { "treasureId": 13, "collect": 1, "goal": 5},
        ]
      },
      "questPrize": {
        "amount": {
          "from": 50,
          "to": 100
        },
        "specialWeaponId": 4
      }
    }
  ]
}

[horizontal]
.Description:
id:: unique id of quest.
roomCoin:: coin of room. (EUR cents)
desc:: description of quest
date:: datetime in msec. from 01.01.1970 (standart unix timestamp)
collect/kills:: current amount of progress for treasures/enemies.
progress::  progress of player. enemies - information about enemies in quest.,  treasures about treaures.
specialWeaponId:: id if special weapon, -1 for prizeType = 0;

[cols="1,8"]
|===
| Quest Type | Description

| 0
| collect N treasures of specific type. (minor quests, prize - special weapons)

| 1
| collect N treasures of specific type. (major quests, prize - money)

|===


[cols="2,7,7,2"]
|===
| TreasureId | Name(Ra) | Name(Pirates) |  Math

| 1
| GOLDEN_STATUE_OF_THE_SPHYNX
| The Tear of Alcyone
| prize_1

| 2
| GOLDEN_STATUE_OF_THE_TUTANKHAMUN
| The Eye of Cassiopeia
| prize_2

| 3
| ONYX_SERVANT_OF_BASTET
| The Heart of Betelgeuse
| prize_3

| 4
| ONYX_STATUE_OF_THE_PHARAOH
| The Soul of Sirius
| prize_4

| 5
| GOLDEN_BUST__OF_ANUBIS
| Captain's Hook
| prize_5

| 6
| KNIGHT_OF_ANUBIS_BUST
| Botswain's Knife
| prize_6

| 7
| SACRED_GOLDEN_PYRAMID
| First Mate's Cutlass
| prize_7

| 8
| THE_GOLDEN_BUST_OF_NEFERTITY
| Captain's Pistol
| prize_8

| 9
| EAGLE_OF_RUBY_AND_EMERALD
| Jeweled Statue
| prize_9

| 10
| GARNET_SCARAB_AMULET
| The Countess' Necklace
| prize_10

| 11
| LAPIS_CUFF_OF_THE_QUEEN
| The Governor's Signet
| prize_11

| 12
| THE_JADE_BROOCH
| Elaborately Jewelled Goblet
| prize_12

| 13
| BRASS_SCARAB_SIGIL
| The Golden Guardian of El Dorado
| prize_13

| 14
| CARTOUCHE_OF_GOLD_AMULET
| Gold Ingots
| prize_14

| 15
| JADE_AND_BRASS_VASE
| Buccaneer's Purse
| prize_15

| 16
| OFFERING_BOWL_OF_GEMS
| Golden Ring
| prize_16

|===

=== 1.20 CollectQuest
To collect quest from Lobby (if supported by game logic), client can send following message
[source,json]
{
  "id": 1,
  "date": 1496748898812,
  "rid": 10,
  "class": "CollectQuest"
}

If player got new level as a result of quest completion, he will receive LevelUpLobby message
[source,json]
{
  "seatId": 1,
  "level": 3,
  "xp": 1200,
  "xpPrev": 1000,
  "xpNext": 2000
  "date": 1496748898815,
  "rid": 10,
  "class": "LevelUpLobby"
}
If request processed successfully, client will receive Ok message

=== 1.21 GetWeapons
Client can receive amount of player's weapons by sending request GetWeapons
[source,json]
{
  "class": "GetWeapons",
  "rid": 11,
  "date": 1587896669683
}

[source,json]
.Response
{
  "weapons": {
    "10.0": [
      {"id": 0, "shots": 0},
      {"id": 1, "shots": 0},
      {"id": 2, "shots": 0},
      {"id": 3, "shots": 0},
      {"id": 4, "shots": 0},
      {"id": 5, "shots": 0},
      {"id": 6, "shots": 5},
      {"id": 7, "shots": 0},
      {"id": 8, "shots": 0},
      {"id": 9, "shots": 0},
      {"id": 10, "shots": 0},
      {"id": 11, "shots": 0}
    ]
  },
  "date": 1587896664560,
  "rid": 11,
  "class": "PlayerWeaponsResponse"
}

[horizontal]
weapons::  map of weapons by coins. id: weapon type id, shots: number of shots.

=== 1.22 TournamentStateChanged
Server sends this message after tournament status changed
[source,json]
{
  "id": 323453,
  "oldState": "ACTIVE",
  "newState": "EXPIRED",
  "reason": "Tournament time is up",
  "date": 1531731629785,
  "rid": -1,
  "class": "TournamentStateChanged"
}

[horizontal]
.Where:
id:: tournament id
reason:: additional info about change state, may be empty.
oldState:: READY, ACTIVE
newState:: ACTIVE, FINISHED, CANCELED

=== 1.23 BonusStatusChanged
Server sends this message after bonus status changed
[source,json]
{
  "id": 345345,
  "type": "FRB",
  "oldStatus": "ACTIVE",
  "newStatus": "FINISHED",
  "reason": "Bonus expired",
  "date": 1531731629785,
  "rid": -1,
  "class": "BonusStatusChanged"
}

.Where:
id:: bonus id
type:: bonus type, may be FRB or CASHBONUS
reason:: additional info about change state, may be empty.
oldStatus:: ACTIVE
newStatus:: RELEASED, LOST, CANCELLED, EXPIRED, CLOSED

=== 1.24 GetBattlegroundStartGameUrl
If player click on any battleground buyIn icon, lobby must send this request for obtain start game in battleground mode.

Request:
[source, json]
{
  "buyIn": 100,
  "date": 1497154790288,
  "rid": 5,
  "class": "GetBattlegroundStartGameUrl
}

.Request parameters:
buyIn:: selected buyIn amount
rid:: unique request id

Response:
[source, json]
{
  "roomId": 5,
  "startGameUrl": "https://host/mpgameloader.jsp?sid=deb0bf169cbb477b6f8430000015cbe83&serverId=1&roomId=5&stake=5",
  "date": 1497155412200,
  "rid": 1,
  "class": "GetStartGameUrlResponse"
}

[horizontal]
.Where:
rid:: request id from “GetRoomInfo”
roomId:: unique room id
startGameUrl:: url for start game.

<<<

== 2. Game protocol
After the game client is loaded, it should open websocket connection to url passed in request parameter gameServletUrl=wss://host:port/websocket/mpgame and then send “OpenRoom” request.

=== 2.1 Error handling
In response to any client request may come an error message like this:
[source,json]
{
  "code": 1,
  "msg": "Internal error",
  "date": 1496748898812,
  "class": "Error",
  "rid": 1
}

[source,json]
{
  "code": 2,
  "msg": "Server shutdown",
  "date": 1496748898812,
  "class": "Error",
  "rid": -1
}

[source,json]
{
  "code": 1005,
  "msg": "Room moved to another server",
  "date": 1496748898812,
  "class": "Error",
  "rid": 9
}

[source,json]
{
  "code": 1003,
  "msg": "Room not found",
  "date": 1496748898812,
  "class": "Error",
  "rid": 10
}

[horizontal]
.Request parameters:
code:: error code
msg:: error description (may be localized)
date:: datetime in msec. from 01.01.1970 (standart unix timestamp)
class:: message class
rid:: request Id, type is int. Optional parameter, if not -1 this parameter contains id of original request.

[horizontal]
.Possible error ranges
1-999:: FATAL ERROR
1000-4999:: ERROR
5000-9999:: WARNING

.Handling 'FATAL ERROR':
Just display message to user and close game.

.Handling Game Websocket errors:
In case of websocket error, you must re-establishing websocket connection to gameServletUrl and resend 'OpenRoom' request.

.Handling 1003, 1005 error:
1. Close current websocket connection to game server
2. Call lobby method 'GetStartGameUrl'
3. Re-establish websocket connection to new startGameUrl
4. Send 'OpenRoom' request

=== 2.2 OpenRoom
After this request is completed, the client goes into observer mode and begins to receive all necessary information about the game.
[source,json]
{
  "roomId": 1,
  "serverId": 1,
  "lang": "en",
  "sid": "eb0bf169cbb477b6f8430000015cbe83",
  "date": 1497157072066,
  "rid": 5,
  "class": "OpenRoom"
}

[horizontal]
.Request parameters:
roomId:: unique room id
serverId:: serverId for connect via websocket
lang:: preffered language
rid:: unique request id
sid:: session identifier send as request parameter on start game client.

.Response:
GetRoomInfoResponse. See paragraph 1.6

If game state is “PLAY” client immediately receives message:
[source,json]
{
  "mapId": 302,
  "subround": "BASE",
  "startTime": 0,
  "state": "PLAY",
  "roomEnemies": [
    {
	  "id": 1,
	  "typeId": 1,
      "speed": 9.0,
      "awardedPrizes": "1,2",
	  "awardedSum": 3.0,
      "energy": 0,
      "fullEnergy": 1250.0,
      "skin": 1,
      "trajectory": [
        { "x": 10, "y": 50, "time": 120, "invulnerable": true },
        { "x": 20, "y": 30, "time": 150 },
        { "x": 30, "y": 30, "time": 250 }
      ],
      "parentEnemyId": -1,
      "members": [],
      "swarmId": 0,
      "swarmType": 0
    },
	{
	  "id": 10,
	  "typeId": 2,
      "speed": 6.5,
	  "awardedPrizes": "1,3",
	  "awardedSum": 4.0,
	  "energy": 45,
      "fullEnergy": 50,
      "skin": 1,
	  "trajectory": [
 	    { "x": 10, "y": 50, "time": 120 },
        { "x": 20, "y": 30, "time": 150 }
	  ],
      "parentEnemyId": -1,
      "members": [],
      "swarmId": 0,
      "swarmType": 0
	}
  ],
  "seats": [
    {
      "id": 0,
      "nickname": "Player",
      "enterDate": 1587912789921,
      "totalScore": 28230.5,
      "currentScore": 0.0,
      "avatar": {
        "borderStyle": 3,
        "hero": 1,
        "background": 2
      },
      "specialWeaponId": -1,
      "level": 8,
      "unplayedFreeShots": 0,
      "totalDamage": 120,
      "betLevel": 1
    }
  ],
  "mines": [],
  "freezeTime": {},
  "immortalBoss": false,
  "roundId": 450063,
  "seatGems": {},
  "cashBonusInfo": {
    "id": 23142,
    "awardDate": 1533284885209,
    "expirationDate": 1533294885209,
    "balance": 1000,
    "amount": 10000,
    "amountToRelease": 200,
    "status": "ACTIVE"
  },
  "tournamentInfo": {
    "id": 23142,
    "name": "New Year's tournament",
    "state": "ACTIVE",
    "startDate": 1533284885209,
    "endDate": 1533284885209,
    "balance": 10000,
    "buyInPrice": 500,
    "buyInAmount": 10000,
    "reBuyAllowed": true,
    "reBuyPrice": 500,
    "reBuyAmount": 100000,
    "reBuyCount": 1,
    "reBuyLimit": -1,
    "resetBalanceAfterRebuy": false
  },
  "battlegroundInfo" {
      "buyIn" : 1000,
      "buyInConfirmed": true,
      "timeToStart" : 0,
      "kingsOfHill": [-1],
      "score": 0,
      "rank" : 0,
      "pot": 3960
  },
  "gemPrizes": {0: 120, 1: 80, 2: 40, 3: 25, 4: 10}
  "betLevel": 1,
  "date": 1587912885176,
  "rid": 5,
  "class": "FullGameInfo"
}

[horizontal]
.Where
roomEnemy:id:: unique enemy instance id
roomEnemy:typeId:: enemy type id.See GetRoomInfoResponse:enemy:id
roomEnemy:awardedPrizes:: prizes (list!) received from hitting the enemy.May be empty if no hits.
roomEnemy:awardedSum:: amount of points received from hits to the enemy
roomEnemy:energy:: remaining energy, if energy<0 enemy is dead, remember that energy=0 used for identify regular enemies
roomEnemy:skin:: enemy skin
freezeTime:: freeze time remaining.
gemPrizes:: prize for each gem

.Trajectory points may contain following additional params
invulnerable:: enemy will be invulnerable between this point and next point
portal:: numeric id of Portal from which enemy should be spawned
teleport:: true if enemy should move from this point using teleport animation, teleport reserves 4 points in trajectory

=== 2.3 CloseRoom
This request must be send to server before close client. This required for release all server resources allocated to client.
[source,json]
{
  "roomId": 1,
  "date": 1497159892576,
  "rid": 5,
  "class": "CloseRoom"
}

[horizontal]
.Request parameters:
roomId:: unique room id
rid:: unique request id

[source,json]
.Response:
{
  "date": 1497154639465,
  "rid": 1,
  "class": "Ok"
}

=== 2.4 SitIn
The request is sent by the client to seat in the room.After the successful execution of this request,
the user moves from the observer state to the player's state and additional actions available to him.
In battleground mode sitIn must be sended only after accept buyIn.If buyIn not accepted need send CloseRoom message.
[source,json]
{
  "date": 1497160498696,
  "rid": 1,
  "stake": 5,
  "class": "SitIn"
}

[horizontal]
.Request parameters:
stake:: stake in cents. This parameter must be 0 for re-sitIn

[source,json]
.Response:
{
  "id": 4,
  "nickname": "Andrey",
  "enterDate": 1497160789104,
  "ammoAmount": 120,
  "balance": 15000,
  "weapons": [
    {"id": 0, "shots": 0},
    {"id": 1, "shots": 0},
    {"id": 2, "shots": 0},
    {"id": 3, "shots": 0},
    {"id": 4, "shots": 7},
    {"id": 5, "shots": 0},
    {"id": 6, "shots": 0},
    {"id": 7, "shots": 0},
    {"id": 8, "shots": 3},
    {"id": 9, "shots": 0},
    {"id": 10, "shots": 0},
    {"id": 11, "shots": 0}
  ],
  "weaponLootBoxPrices": [100.0, 200.0, 400.0],
  "avatar": {
    "borderStyle": 1,
    "hero": 1,
    "background": 10
  },
  "showRefreshBalanceButton": true,
  "level": 8,
  "frbMode": false,
  "frbBalance": 0,
  "mode": "FRB",
  "date": 1497160789056,
  "rid": 2,
  "class": "SitInResponse"
}

[horizontal]
.Where:
rid:: request id from “SitIn”
id:: seat number
nickname:: seat nickname
ammoAmount:: summary ammo amount
balance:: current player balance
avatar:: seat avatar
weaponLootBoxPrice:: Weapon Loot Box price in cents
showRefreshBalanceButton:: need show "Refresh Balance" button
frbMode:: deprecated parameter, see 'mode' (will be deleted after client fix)
frbBalance:: deprecated parameter (will be deleted after client fix)
mode:: game mode, possible values FRB, CASHBONUS, REAL,TOURNAMENT

Other clients also receive this response, but with rid=-1.

=== 2.5 SitOut
The request is sent by the client in order to seat out from the room. After that the user goes into observer mode.
For tournaments, cashbonus, frbonus modes, not required send a SitOut request, this will be done automatically and
the client will receive a SitOutResponse message.
[source,json]
{
  "date": 1497161230259,
  "rid": 1,
  "class": "SitOut"
}

[source,json]
.Response:
{
  "id": 4,
  "nickname": "Andrey",
  "outDate": 1497161341687,
  "compensateSpecialWeapons": 304,
  "surplusHvBonus": 104,
  "totalReturnedSpecialWeapons": 10,
  "nextRoomId": 32445,
  "hasNextFrb": true,
  "date": 1497161341653,
  "rid": 1,
  "class": "SitOutResponse"
}

[horizontal]
.Where:
rid:: request id from “SitOut”
id:: seat number
nickname:: seat nickname
compensateSpecialWeapons:: compensate win for unused special weapons
surplusHvBonus:: compensate win for pot of HV Runner
totalReturnedSpecialWeapons:: amount of returned special weapons
nextRoomId:: roomId for sitIn to real room (after cashBonus or tournament), may be -1 if there is no suitable room
hasNextFrb:: after cashbonus or frb completed, this flag indicating that exist new FRBonus

Other clients also receive this response, but with rid=-1.

=== 2.6 GameStateChanged
This message sent from server to all clients on each game state change.

[source,json]
{
  "state": "PLAY",
  "ttnx": 600,
  "roundId": 12345,
  "date": 1497171419692,
  "rid": 1,
  "class": "GameStateChanged"
}

[horizontal]
.Where:
state:: current room state. Possible values: WAIT, PLAY, QUALIFY, CLOSED
ttnx:: rough time to next state in seconds, -1 for unknown
roundId:: current round id
rid:: request id, always -1

=== 2.7 NewEnemy
This message sent from server to all clients when there is a new enemy
[source,json]
{
  "newEnemy": {
    "id": 1,
	"typeId": 1,
    "speed": 3.0,
    "awardedPrizes": "",
    "awardedSum": 0,
    "energy": 0,
    "fullEnergy": 100,
    "skin": 2,
    "trajectory": [
      { "x": 10, "y": 50, "time": 120 },
	  { "x": 20, "y": 30, "time": 150 }
	],
    "parendEnemyId": -1,
    "members": [],
    "swarmId": 0,
    "swarmType": 0
  },
  "date": 1497173799426,
  "rid": -1,
  "class": "NewEnemy"
}

newEnemy is same as FullGameInfo:roomEnemies in paragraph 2.2

=== 2.7.1 NewEnemies
This message will be sent to all clients when a lot of enemies is spawned at once, for example - scarab swarms
[source,json]
{
  "date": 1497173799426,
  "rid": -1,
  "class": "NewEnemies",
  "enemies": [
    {
      "id": 1,
      "typeId": 1,
      "speed": 3.0,
      "awardedPrizes": "",
      "awardedSum": 0,
      "energy": 0,
      "fullEnergy": 100,
      "skin": 2,
      "trajectory": [
      	{ "x": 10, "y": 50, "time": 120 },
        { "x": 20, "y": 30, "time": 150 }
      ],
      "parendEnemyId": -1,
      "members": [],
      "swarmId": 2,
      "swarmType": 3
    },
    {
      "id": 2,
      "typeId": 1,
      "speed": 3.0,
      "awardedPrizes": "",
      "awardedSum": 0,
      "energy": 0,
      "fullEnergy": 100,
      "skin": 1,
      "trajectory": [
        { "x": 10, "y": 50, "time": 120 },
        { "x": 20, "y": 30, "time": 150 }
      ],
      "parendEnemyId": -1,
      "members": [],
      "swarmId": 2,
      "swarmType": 3
    }
  ]
}

=== 2.8 BuyIn
The request is sent by the client if need buy ammo. Not available in battleground mode.
[source,json]
{
  "ammoAmount": 100,
  "date": 1497174203319,
  "rid": 10,
  "class": "BuyIn"
}

[horizontal]
ammoAmount:: amount of ammunition purchased

[source,json]
.Response:
{
  "ammoAmount": 120,
  "balance": 15000,
  "date": 1497174620105,
  "rid": 10,
  "class": "BuyInResponse"
}

[horizontal]
.Where:
rid:: request id from “BuyIn” request
ammoAmount:: summary ammo amount
balance:: current balance in cents

=== 2.10 Shot
This request is sent by the client when the shot is fired. Response for shot request returned to all players. If a special weapon was used, then more than one answer can be sent / miss
[source,json]
{
  "bulletId": "0_0"
  "weaponId": -1,
  "enemyId": 5,
  "x": 35.0,
  "y": 250.5,
  "isPaidSpecialShot": false,
  "date": 1497177502148,
  "rid": 34,
  "class": "Shot"
}

[horizontal]
.Where:
enemyId:: unique enemy id of who made the shot
weapon:: id of used weapon, -1 for regular weapon
bulletId:: bulletId for shot. (in new games, see 2.40)

If player miss, server return
[source,json]
{
  "seatId": 2,
  "killedMiss": true,
  "awardedWeaponId": -1,
  "enemyId": 2,
  "usedSpecialWeapon": 1,
  "awardedWeaponShots": 0,
  "remainingSWShots": 3,
  "score": 5,
  "hit": false,
  "lastResult": false,
  "x": 55.0,
  "y": 214.0,
  "mineId": "0_1550487688500"
  "shotEnemyId": 5,
  "invulnerable": false,
  "betLevel": 1,
  "bulletId": "0_0",
  "class": "Miss",
  "date": 1497177502148,
  "rid": -1
}

[horizontal]
.Where:
seatId:: seat id that made shot
killedMiss:: true if a shot is fired on an already killed enemy. The money for this shot is returned to the player.
awardedWeaponId:: if special weapon awarded, awardWeaponId contains weapon id, -1 if no award. Any shot has a chance to get special weapons
usedSpecialWeapon::  special weapon id used for this shot. For regular weapon, always=-1
remainingSWShots:: number of remaining shots for current special weapon. For regular weapon, always=0
enemyId:: enemy which is hit by weapon
shotEnemyId:: original shot target
invulnerable:: true if a shot is fired when an enemy was in invulnerable state. Client should cancel shot animation and return ammo to the player
betLevel:: bet level which was active when player performed shot

If player hit, server return:
[source,json]
{
  "seatId": 0,
  "damage": 0.0,
  "win": 14.0,
  "awardedWeaponId": -1,
  "usedSpecialWeapon": 7,
  "remainingSWShots": 7,
  "score": 1.4,
  "enemy": {
    "id": 9125,
    "typeId": 4,
    "speed": 6.0,
    "awardedPrizes": "",
    "awardedSum": 0.0,
    "energy": 2.147483647E9,
    "fullEnergy": 100.0,
    "skin": 1,
    "parentEnemyId": -1,
    "members": [],
    "swarmId": 0,
    "swarmType": 0
  },
  "hit": true,
  "awardedWeaponShots": 0,
  "killed": true,
  "lastResult": false,
  "multiplierPay": 0,
  "killBonusPay": 0.0,
  "currentWin": 14.0,
  "hvEnemyId": -1,
  "x": 822.3107,
  "y": 287.30884,
  "mineId": "",
  "newFreeShots": 0,
  "newFreeShotsSeatId": 0,
  "hitResultBySeats": {
    "0": [
      {"id": 0, "value": "14.0"}
    ]
  },
  "instanceKill": false,
  "chMult": 1,
  "awardedWeapons": [],
  "needExplode": false,
  "isExplode": false,
  "gems": [],
  "enemyId": 9125,
  "shotEnemyId": 9125,
  "enemiesInstantKilled": {},
  "betLevel": 1,
  "isPaidSpecialShot": false,
  "rage": [
    { "id": 123, "damage": 10.0 },
    { "id": 234, "damage": 20.0 }
  ],
  "enemiesWithUpdatedMode": [
        {enemyId: 19, enemyMode: 1}
    ]
  ,
  "bulletId": "0_0",
  "date": 1592283785789,
  "rid": 32,
  "class": "Hit"
}

[horizontal]
.Where:
seatId:: seat id that made a shot
damage:: caused damage to the enemy
win:: base win  in cents (type is float)
awardedWeaponId:: if special weapon awarded, awardWeaponId contains weapon id, -1 if no award
usedSpecialWeapon::  special weapon id used for this shot. For regular weapon, always=-1 (see 5.0)
awardedWeaponShots:: number of awarded shots of special weapon from  awardedWeaponId
hvEnemyId:: id of new HV enemy after killing of current enemy. Info about new HV enemy will be sent via NewEnemy message.
Default value is "-1" (no HV enemy).
killed:: true/false - enemy is killed or no
lastResult:: true/false. true is  it is the last hit of shot. (relevant for SW)
remainingSWShots:: number of remaining shots for current special weapon. For regular weapon, always=0
multiplierPay:: the additional multiplier for wins(not relevant for current Pirates)
killBonusPay:: win bonus for killing, for Pirates = 0.
currentWin:: Money (in cents). The current win of seat. (include all last payouts for shot together with the unconverted amount to shots)
hvEnemyId:: id of HV enemy. (not used in Pirates)
newFreeShots:: type is  integer. It is number of new appeared free shots.
newFreeShotsSeatId:: type is integer. id of seat which received free shots.
hitResultBySeats:: map of hit results for all seaters.  id: type of result (0 - win (value is win in cents), 1 - treasure (value is name of treasure), 2 - SW (value is type of SW)), 4 - money wheel win (value is win in cents)
instanceKill:: type is boolean, instant kill appeared or no. (not relevant for current Pirates)
chMult:: type is integer.  the additional multiplier for wins(not relevant for current Pirates)
needExplode:: type is boolean, true for exploding enemies (not relevant for current Pirates)
isExplode:: type is boolean.  True if the enemy is the source of the explosion and the explosion occurred (not relevant for current Pirates)
gems:: array of integers. appeared gems for this hit.  (not relevant for current Pirates)
enemy:: state of the affected enemy, same as RoomEnemy in paragraph 2.2
enemyId:: id of enemy for this hit.
shotEnemyId:: id of shot enemy.
enemiesInstantKilled:: map of hit results for instant killing (not relevant for current Pirates)
enemy.id and all other attributes may be different from the one for whom the shot was fired.
This is possible if the enemy is already killed by another player. The client must correctly process the animation of the rebound and the defeat of another enemy. Also keep in mind that the Hit.message does not contain a field "trajectory", as it is not necessary.
rid::  request id for the player who made the shot, -1 for all other players.
mineId:: id of mine. (seatId_time of mine placing)
betLevel:: bet level which was active when player performed shot
isPaidSpecialShot:: true if player used purchased special weapon
rage:: (DragonStone) when Hit triggers rage effect, you will receive list of enemies with an amount of damage which should be done to them
effects:: (DragonStone) if enemy during hit has some effects applied to him, you will receive list of these effects - for example FIRE_SPECTER, LIGHTNING_SPECTER
enemiesWithUpdatedMode:: enemy with updated modes. 0 - X1 enemy mode (default), 1 - X2 enemy mode)


=== 2.11 GetFullGameInfo
[source,json]
This request can be sent by the client if connection lost and need refresh all room info.
{
  "date": 1497178236042,
  "rid": 1,
  "class": "GetFullGameInfo"
}

Response: same as FullGameInfo in paragraph 2.2

=== 2.12 RoundResult
After round finished all clients receive message “GameStateChanged” described in paragraph 2.6 with state=QUALIFY. After qualification completed all clients receive round result in message:
[source,json]
{
  "winAmount": 500.5,
  "winRebuyAmount": 300.0,
  "balance": 12000,
  "hitCount": 5,
  "missCount": 25,
  "currentScore": 30,
  "totalScore": 350,
  "nextMapId": 504,
  "seats": [
    {
      "id": 0,
      "nickname": "John",
      "enterDate": 1497179064797,
      "totalScore": 700.0,
      "currentScore": 350.0,
      "avatar": {
        "borderStyle": 1,
        "hero": 1,
        "background": 10
      },
      "specialWeaponId": -1,
      "level": 3,
      "unplayedFreeShots": 0,
      "totalDamage": 20.0,
      "betLevel": 1
    },
    {
      "id": 1,
      "nickname": "Mike",
      "enterDate": 1497179064797,
      "totalScore": 230.0,
      "currentScore": 10.0,
      "avatar": {
        "borderStyle": 1,
        "hero": 1,
        "background": 10
      },
      "specialWeaponId": 1,
      "level": 5,
      "unplayedFreeShots": 0,
      "totalDamage": 200.0,
      "betLevel": 2
    },
    {
      "id": 3,
      "nickname": "Fred",
      "enterDate": 1497179064797,
      "totalScore": 0,
      "currentScore": 0,
      "avatar": {
        "borderStyle": 1,
        "hero": 1,
        "background": 10
      },
      "specialWeaponId": 1,
      "level": 1,
      "unplayedFreeShots": 0,
      "totalDamage": 0.0,
      "betLevel": 1
    }
  ],
  "enemiesKilledCount": 95,
  "winAmountInCredits": 9524,
  "unusedBulletsCount": 95,
  "unusedBulletsMoney": 9524,
  "totalBuyInMoney": 102,
  "surplusHvBonus": 102,
  "xpPrev": 1000,
  "weaponSurplus":[
    {
      "id": 0,
      "shots": 332,
      "winBonus": 234
    },
    {
      "id": 1,
      "shots": 210,
      "winBonus": 1525
    }
  ],
  "totalKillsXP": 767,
  "totalTreasuresCount": 1,
  "totalTreasuresXP": 100,
  "beforeRound": {
    "level": 2,
    "score": 1885,
    "minScore": 1000,
    "maxScore": 3000
  },
  "afterRound": {
    "level": 2,
    "score": 1885,
    "minScore": 1000,
    "maxScore": 3000
  },
  "surplusHvBonus": 0,
  "questsCompletedCount": 0,
  "questsPayouts": 0,
  "roundId": 1090142,
  "weaponsReturned": [
  ],
  "bulletsFired": 5,
  "realWinAmount": 10.0
  "freeShotsWon": 5,
  "moneyWheelCompleted": 1,
  "moneyWheelPayouts": 25,
  "totalDamage": 10,
  "date": 1497179064748,
  "rid": -1,
  "class": "RoundResult",
  "battlegroundRoundResult": [
    {
       "id": 0,
       "score": 12324,
       "rank": 1,
       "pot": 3960
    },
    {
       "id": 1,
       "score": 11324,
       "rank": 2,
       "pot": 0
    },
    {
       "id": 2,
       "score": 10324,
       "rank": 3,
       "pot": 0
    },
    {
       "id": 5,
       "score": 1324,
       "rank": 4,
       "pot": 0
    }
  ]
}

[horizontal]
.Where:
winAmount:: amount won in this round (type - float)
winRebuyAmount:: win used for rebuy ammo
balance:: current player balance
totalScore:: total number of points awarded player in this room (total win = totalScore*stake), 	type=integer
currentScore:: number of points awarded player for current round (currentWin = 	currentScore*stake), type=integer
nextMapId:: id of map that will be used in next round (used for preloading of resources)
hitCount:: hit count for this round
missCount:: miss count for this round
seat:rankPoints:: total number of points received by the player, see 4.3 section is spec.
seats is same as  GetRoomInfoResponse:seats in paragraph 1.4
unusedBulletsCount:: count of unused bullets in round.
unusedBulletsMoney:: amount of unused bullets in round (cents)
totalBuyInMoney:: total amount of all BuyIns in this round (cents)
weaponSurplus:: weapons surplus amounts, id - type of special weapon, shots - number of shots. winBonus - amount in cents.
moneyWheelCompleted:: number of times player completed money wheel during this round
moneyWheelPayouts:: amount of money player received for completing money wheel
totalDamage:: total amount of damage player dealt to enemies in this round
battlegroundRoundResult:: battleground mode leaderboard info

=== 2.13 ChangeMap
The server can send a message about changing the current map (for example, when a boss appears)
[source,json]
{
  "class": "ChangeMap",
  "mapId": 2,
  "subround": "BASE",
  "rid": -1,
  "date": 34534534
}

[horizontal]
.Where:
mapId:: new map identifier (now only one map with id=1 available)
subround:: reason for changeMap (class of enemies available for this map, also may be classified as subround), possible values: BASE, BOSS

=== 2.14 EnemyDestroyed
After the enemy was destroyed (for example, as a result of a shot), the server sends this message
[source,json]
{
  "enemyId": 100,
  "reason": 0,
  "date": 1521872381930,
  "rid": -1,
  "class": "EnemyDestroyed"
}

[horizontal]
.Where:
enemyId:: destroyed enemy identifier
reason:: identifier of the event as a result of which the enemy was destroyed. The client can use this field for the different death animations. Existing types: 0 - death as a result of a shot from regular weapons

=== 2.15 Awards (Deprecated)
When enemy is killed, player can receive additional non-money award, which consist of leader-board points and collectible items. +
When such award is granted, player will receive message:
[source,json]
{
  "awards": [
    { "seatId": 0, "score": 1, "qualifyWin": 481, "treasures": [42] },
    { "seatId": 1, "score": 481, "qualifyWin": 481,  "treasures": [5, 10] }
  ],
  "class": "Awards"
  "date": 1529659911798,
  "enemyId": 463,
  "rid": -1
}

[horizontal]
.Where:
awards:: complete list of awards for enemy kill
awards.seatId:: seatId of player that received award
awards.score:: amount of awarded leader-board points
awards.treasures:: list of ids of dropped treasures
enemyId:: id of killed enemy
qualifyWin:: shared prize of player for boss (cents)

For more info about available treasures, please see achievements specification.

=== 2.16 LevelUp
This message is sent to the player when he reaches new character level
[source,json]
.Response
{
  "class": "LevelUp",
  "date": 1496748898812,
  "rid": -1,
  "seatId": 1,
  "level": 5
}

=== 2.17 PurchaseWeaponLootBox
This message is sent by client to purchase loot box with a random special weapon
[source,json]
.Request
{
  "class": "PurchaseWeaponLootBox",
  "date": 1496748898812,
  "box": 3,
  "rid": 10
}

box:: number of selected box for purchase

[source,json]
.Response
{
  "class": "WeaponLootBox",
  "date": 1496748898812,
  "rid": 10,
  "weaponId": 3,
  "shots": 100,
  "balance": 100500,
  "currentWin": 2300,
  "usedAmmoAmount": 10
}

weaponId:: id of awarded weapon
shots:: amount of awarded shots with this weapon
balance:: player's balance after purchase
currentWin:: remainder of player's win after purchase
usedAmmoAmount:: purchase can be made at the expense of ammo

=== 2.18 Weapons
At the start of a round, server will send a message with a description of weapons currently owned by player
[source,json]
.Response
{
  "class": "Weapons",
  "date": 1496748898812,
  "rid": -1,
  "ammoAmount": 100,
  "freeShots": false,
  "weapons": [
    { "id": 1, "shots": 5 },
    { "id": 2, "shots": 3 }
  ]
}

ammoAmount:: amount of regular bullets
freeShots:: true if regular bullets are free (FRB mode, deprecated)
weapons:: list of special weapons currently owned by player with a number of remaining shots

=== 2.19 RefreshBalance
Sended from client after press "Refresh balance" button. Server side return message 1.15 "BalanceUpdated"
[source,json]
.Response
{
  "clientAmmo": 253,
  "class": "RefreshBalance",
  "date": 1496748898812,
  "rid": 1
}

=== 2.20 FRBEnded
After FRB completed, server send FRBEnded message. Client must display close reason (Completed, Canceled, Expired)
and win sum. After close message box, need close client and resend from lobby messages: EnterLobby
[source,json]
.Response
{
  "winSum":1200,
  "closeReason":"Completed",
  "hasNextFrb":true
  "date":1533285929327,
  "rid":-1,
  "class":"FRBEnded"
}

=== 2.21 SwitchWeapon
When player activates different weapon, client should send this message to server
[source,json]
.Request
{
  "class": "SwitchWeapon",
  "date": 1533285929327,
  "rid": 1,
  "weaponId": 2
}

If everything is Ok, then response will contain exactly the same message

=== 2.22 SyncLobby
When client plans to show Rooms List in a Lobby while a player still plays in a room,
client should send to the game room following message to update list of available Special Weapons:
[source,json]
.Request
{
  "class": "SyncLobby",
  "date": 1533285929327,
  "rid": 10
}

[source,json]
.Response
{
  "class": "Ok",
  "date": 1533285929327,
  "rid": 10
}

If this message was not send, than list of available special weapons for current stake could be empty or outdated.

=== 2.23 UpdateTrajectories
Server may send such message to client to inform it about the changes in movement trajectories of enemies.
[source,json]
{
  "class": "UpdateTrajectories",
  "rid": -1,
  "freezeTime": 3000,
  "animationId": 0,
  "trajectories": {
    10: {speed: 4, points: [{x: -240, y: 140.625, time: 1535004949556}, {x: -50, y: 247.5, time: 1535004959056}]},
    11: {speed: 3, points: [{x: -50, y: 472.5, time: 1535004990056}, {x: 860, y: -39.375, time: 1535005035556}]}
  }
}

The key in trajectories field is an enemyId and value is a new trajectory.
freezeTime: freezeTime for enemies. (ms)

=== 2.24 CloseRoundResults (Deprecated)
During Qualify state client may send following message to force start of next round.
[source,json]
{
  "class": "CloseRoundResults",
  "rid": 10,
  "date": 1533285929327
}
Next round will be started once this message is received from all players in a room or when maximal wait time is over

=== 2.25 RoundFinishSoon
When round is coming to an end server will send following message
[source,json]
{
  "class": "RoundFinishSoon",
  "rid": -1,
  "date": 1533285929327
}

=== 2.26 NewTreasure
When treasure finish quests server will send following message
[source,json]
{
  "class": "NewTreasure",
  "rid": -1,
  "date": 1533285929327,
  "id": 7,
  "enemyId": 23
  "completedQuestId": 1,
  "questId": 1
}

=== 2.27 Update Quest
If progress of quest is updated, client will receive following message, if needReset=true amount is new.
[source,json]
{
  "class": "UpdateQuest",
  "date": 1496748898812,
  "rid": -1,
  "lastEnemyId": 100,
  "quest": {
    "id": 1,
    "type": 4,
    "roomCoin": 5
    "needReset": false,
    "progress": {
      "treasures": [
        { "treasureId": 2, "collect": 2, "goal": 3 }
      ]
    },
    "questPrize": {
      "amount": { "from": 50, "to": 100 },
      "specialWeaponId": 4
    },
    "collectedAmount": 200
  }
}

=== 2.30 Place Mine to Map
This request is sent by the client when need to place mine to map.
[source,json]
{
  "x": 25.3,
  "y": 44.8,
  "isPaidSpecialShot": false,
  "date": 1497177502148,
  "rid": 34,
  "class": "MineCoordinates"
}

[horizontal]
.Where:
x, y:: coordinates of place

.Wrong coordinates
If x,y are wrong coordinates (wall, ...), then server return
[source,json]
{
  "code": 1023,
  "msg": "Wrong coordinates",
  "date": 1496748898812,
  "class": "Error",
  "rid": 34
}

.Success response for all seaters:
[source,json]
{
  "mineId": "0_1550487688500",
  "seatId": 0,
  "date": 1496748898812,
  "class": "MinePlace",
  "rid": 34,
  "x": 367.2334,
  "y": 280.29443,
}

[horizontal]
.Where:
mineId:: seatId_time of mine placing

=== 2.31 Add Free Shots to queue
This request is sent by the client when need add free shots to current/next queue.
[source,json]
{
  "date": 1497177502148,
  "rid": 34,
  "queue": "current"
  "class": "AddFreeShotsToQueue"
}

[horizontal]
.Where:
queue:: type of queue. current/next

.Wrong adding of unplayed free shots.
[source,json]
{
  "code": 1025,
  "msg": "Wrong free shots",
  "date": 1496748898812,
  "class": "Error",
  "rid": 34
}

.Success response for player:
[source,json]
{
  "date": 1496748898812,
  "class": "Ok",
  "rid": 34
}

=== 2.32 ReBuy
.Request
[source,json]
{
  "date": 1496748898812,
  "class": "ReBuy",
  "rid": 5
}

.Response
[source,json]
{
  "date": 1496748898812,
  "class": "ReBuyResponse",
  "rid": 5,
  "ammoAmount": 10000,
  "balance": 12345,
  "rebuyCount": 2
}

=== 2.33 TournamentStateChanged
same as 1.22 TournamentStateChanged

=== 2.34 BonusStatusChanged
same as 1.23 BonusStatusChanged

=== 2.35 Change bet level in room
The request is sent by the client if need change bet level in room.
[source,json]
{
  "betLevel": 5,
  "date": 1497174203319,
  "rid": 10,
  "class": "BetLevel"
}

[horizontal]
betLevel:: requested bet level

[source,json]
.Success response for player:
{
  "betLevel": 5,
  "date": 1497174620105,
  "rid": 10,
  "class": "BetLevelResponse"
}

.Wrong change of bet level
[source,json]
{
  "code": 1027,
  "msg": "Not allowed change bet level",
  "date": 1496748898812,
  "class": "Error",
  "rid": 10
}

[horizontal]
.Where:
rid:: request id from “BetLevel” request
betLevel:: bet level in room

=== 2.36 Rise
When an enemy casts spell Rise in DragonStone, you will receive following message:
[source,json]
{
  "caster": 123,
  "target": 234,
  "enemies": [
    {
      "id": 1,
	  "typeId": 1,
      "speed": 3.0,
      "awardedPrizes": "",
      "awardedSum": 0,
      "energy": 0,
      "fullEnergy": 100,
      "skin": 2,
      "trajectory": [
        { "x": 10, "y": 50, "time": 120 },
	    { "x": 20, "y": 30, "time": 150 }
	  ],
      "parendEnemyId": -1,
      "members": [],
      "swarmId": 0,
      "swarmType": 0
    }
  ],
  "date": 1496748898812,
  "class": "Rise",
  "rid": 10
}

caster:: id of enemy who casts a spell
target:: id of recently killed enemy
enemies:: list of summoned enemies, all properties are the same as in 2.7 NewEnemy message

=== 2.38 Fragments of Dragon Stone
Note: this message could be updated after feedback from Design team

When enemy is killed, it can drop fragment Dragon Stone
In this case player will receive following message:
[source,json]
{
  "fragmentId": 2,
  "date": 1496748898812,
  "class": "DragonStone",
  "rid": 10
}

fragmentId:: id of dragon stone fragment, when all fragments are collected, boss will appear
rid:: id of shot message, original message should be used to determine coordinates of enemy for drop animation

=== 2.39 Mini Slot
Note: this message could be updated after feedback from Design team
At this moment we decided to send results of all spins at once to reduce game complexity
You should subtract win amount of these spins from balance until animation is shown
Animation should be delayed during boss fights

When shot triggers Mini Slot feature, you will receive following message:
[source, json]
{
  "spins": [
    { "reels": [0, 3, 4], "win": 25.0 },
    { "reels": [2, 5, 6], "win": 0.0 },
    { "reels": [3, 5, 3], "win": 50.0 },
    { "reels": [1, 2, 3], "win": 0.0 },
    { "reels": [2, 3, 4], "win": 0.0 }
  ],
  "date": 1496748898812,
  "class": "Slot",
  "rid": 10
}

spins:: list of spin results
spins:reels:: positions on reels, order of reels will be sent in 1.2 EnterLobbyResponse message
spins:win:: win amount in cents of player's currency
rid:: id of shot message, which triggered Mini Slot feature


=== 2.40 Place Bullets to Map.
Note: Bullet message client send for Pistol/Turret weapon for synchronization bullet info between clients.

[source, json]
{
      "bulletTime":1617613404701,
      "bulletAngle":-0.15,
      "bulletId":"0_1",
      "startPointX":531,
      "startPointY":480,
      "endPointX":869,
      "endPointY":428,
      "class":"Bullet",
      "rid":9,
      "date":1617613405521
}

[source,json]
.Success response for each player:
{
      "bulletTime":1617613404701,
      "bulletAngle":-0.15,
      "bulletId":"0_1",
      "startPointX":531,
      "startPointY":480,
      "endPointX":869,
      "endPointY":428,
      "class":"BulletResponse",
      "rid":9,
      "date":1617613404721
}

=== 2.41 CancelBattlegroundRound
Message received to game client if battleground round canceled.Cliet must display meassage and return to lobby.
[source, json]
{
      "refundedAmount": 1000,
      "reason": NOT_ENOUGH_PLAYERS,
      "class":"CancelBattlegroundRound",
      "rid":9,
      "date":1617613404721
}

refundedAmount:: returned buyIn, may be 0 if played not make buyIn
reason:: cancel reason. enum with possible values: NOT_ENOUGH_PLAYERS, SERVER_FAILURE

=== 2.42 KingOfHillChanged
Message sended after change King of the Hill
[source, json]
{
      "newKings": [1,2,3],
      "class":"KingOfHillChanged",
      "rid":9,
      "date":1617613404721
}

newKings:: new King seatIds

=== 2.43 ConfirmBattlegroundBuyIn
Message must be sended game client if player confirm buyIn for next battleground

[source, json]
{
      "class":"ConfirmBattlegroundBuyIn",
      "rid":9,
      "date":1617613404721
}

[source,json]
.Success response:
{
  "date": 1531731629785,
  "rid": 9,
  "class": "Ok"
}

=== 2.44 Crash Bet
The request is sent by the client if need make bet in crash game.
[source,json]
{
  "crashBetAmount": 100,
  "multiplier": 1.35,
  "autoPlay": false,
  "date": 1497174203319,
  "rid": 10,
  "class": "CrashBet"
}

[horizontal]
crashBetAmount:: amount of crash bet (cents)
multiplier:: crash multiplier of bet
autoPlay:: need auto collect on this multiplier.

[source,json]
.Response:
{
  "ammoAmount": 120,
  "balance": 15000,
  "date": 1497174620105,
  "crashBetKey": 1497174620105_0,
  "rid": 10,
  "class": "CrashBetResponse"
}

=== 2.45 Cancel Crash Bet
The request is sent by the client if need cancel bet in crash game. Player will get win with current multiplier.
[source,json]
{
  "crashBetId": 1497174620105_0,
  "date": 1497174203319,
  "rid": 10,
  "class": "CrashCancelBet"
}

[horizontal]
crashBetId:: id of crash bet for 2.44 (string)

[source,json]
.Response:
{
  "currentMult": 2.3,
  "seatId": 45,
  "seatWin": 1550,
  "date": 1497174620105,
   "rid": 10,
  "class": "CrashCancelBetResponse"
}

=== 2.46 CrashStateInfo
The response is sent by the server to all players if multipliers was changed in room.
[source,json]
{
  "currentMult": 3.1,
  "date": 1497174203319,
  "rid": 10,
  "class": "CrashStateInfo"
}



[horizontal]
.Where:
rid:: request id from “BuyIn” request
crashBetAmount:: amount of crash bet (cents)
crashBetKey:: key of crash bet (will be needed later in cancel of bet)
balance:: current balance in cents


<<<

== 3. Enemy Skins (Wrath of Ra)
.Enemy Skins
|===
| Enemy Type | Skin Id | Description

| 0
| 1
| Scarab

| 0
| 2
| Black Scarab

| 1
| 1
| Gold Scarab

| 2
| 1
| Diamond Scarab

| 2
| 2
| Ruby Scarab

| 3
| 1
| Small Mummy

| 4
| 1
| Small Black Mummy

| 5
| 1
| Small White Mummy

| 6
| 1
| Walking Mummy Warrior

| 6
| 2
| Running Mummy Warrior

| 7
| 1
| Mummy God Red

| 8
| 1
| Mummy God Green

| 16
| 1
| Anubis

| 16
| 2
| Osiris

| 16
| 3
| Thoth
|===

<<<

== 4. Error codes
|===
| Error code | Error name | Description

| 1
| INTERNAL_ERROR
| Unexpected error, please report it to BSG Server team

| 2
| SERVER_SHUTDOWN
|

| 3
| INVALID_SESSION
| Please use another token to login into the game

| 4
| DEPRECATED_REQUEST
|

| 5
| FOUND_PENDING_OPERATION
| This user is unable to login due to problems with his account

| 6
| CLOSE_FRB_IN_PROGRESS
| Message is removed from the game

| 7
| UNKNOWN_GAME_ID
| Wrong game id

| 8
| FOUND_OPEN_LOBBY_SESSION
| Found other open lobby for EnterLobby (and game mode conflict).

| 1000
| ILLEGAL_NICKNAME
| Nickname contains banned patterns, please use another one

| 1001
| BAD_REQUEST
| Message received from the client has invalid format

| 1002
| NOT_LOGGED_IN
| Please restart game

| 1003
| ROOM_NOT_FOUND
| Please select another room

| 1004
| TOO_MANY_OBSERVERS
| Room is full, please select another one

| 1005
| ROOM_MOVED
| Room moved to another server

| 1006
| TOO_MANY_PLAYER
| All 6 slots for players are taken, you can observe game until one is freed or pick another one

| 1007
| NOT_SEATER
| You should perform SitIn operation before you can make actions in this room

| 1008
| NOT_ENOUGH_MONEY
| There is not enough money for purchase

| 1009
| BAD_STAKE
| Invalid stake size is provided by client

| 1010
| BAD_BUYIN
| Invalid BuyIn request is send by client

| 1011
| CHANGE_STAKE_NOT_ALLOWED
| Change of stake is forbidden at this moment (not used)

| 1012
| ROOM_NOT_OPEN
| You should send OpenRoom request first

| 1013
| ROUND_NOT_STARTED
| You need to wait until round is started until you can make actions in this room

| 1014
| NEED_SITOUT
| You should perform SitOut request

| 1015
| WRONG_WEAPON
| You are trying to perform shot using inactive weapon

| 1016
| NICKNAME_NOT_AVAILABLE
| Nickname is already taken by another player, please pick another one

| 1017
| AVATAR_PART_NOT_AVAILABLE
| You are trying to use avatar which is not available for this account yet

| 1018
| NOT_ENOUGH_BULLETS
| You need to purchase bullets before you can shoot

| 1019
| REQUEST_FREQ_LIMIT_EXCEEDED
| You are trying to send requests too fast, please limit rate

| 1020
| QUEST_IS_NOT_COMPLETED
| You can't collect quest which is not completed

| 1021
| BUYIN_NOT_ALLOWED
| You can perform BuyIn in this game state

| 1022
| QUEST_ALREADY_COLLECTED
| You already collected this quest

| 1023
| WRONG_MINE_COORDINATES
| You are trying to place mine on invalid location

| 1024
| BOSS_ROUND_STARTED
| Not used

| 1025
| WRONG_UNPLAYED_FREE_SHOTS
| Not used

| 1026
| NOT_FATAL_BAD_BUYIN
| Buy in is failed, but you can proceed with playing

| 1027
| NOT_ALLOWED_CHANGE_BET
| This message is sent by server when changing of bet levels is prohibited to avoid cheats with RTP

| 1028
| NOT_ALLOWED_CHANGE_NICKNAME
| Change nickname not allowed

| 1030
| NOT_ALLOWED_SITIN
| Sit in is not allowed during Qualify game state, client should wait and resend request

|===

== 5. Special Weapons
|===
| Title | Type Id

| Shotgun
| 0

| Grenade
| 1

| Machine Gun
| 2

| Laser
| 3

| Plasma Rifle
| 4

| Mine Launcher
| 5

| Railgun
| 6

| Artillery Strike
| 7

| Rocket Launcher
| 8

| Flamethrower
| 9

| Cryogun
| 10

| Rapid Fire Pistol
| 11

|===
